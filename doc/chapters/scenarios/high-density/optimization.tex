\subsection{Optimization for the high density
scenario}\label{subsec:hdoptimization}

As we have seen, there is not much to do to optimize the \standout{percentage of
covered users}, since it is always nearly perfect. But, of course, there are
very low values of the parameters that does not allow the network to reach the
maximum coverage. We have run a full factorial analysis, with low values of each
parameter, in order to identify the minimum values required to reach the
coverage. Each possible configuration (\(750\)) has been run with 10
repetitions. The complete analysis can be found in \code{coverage.ipynb}. The
configuration used is named ``HighDensityCoverage''. We have found out that to
reach at least the \(99\%\) of the coverage, we need to have a broadcast radius
of at least \(7m\), but we also need higher values for \(m\) and \(D\) in order
to use \(R\!=\!7m\). If we use \(R\!=\!8m\) we get better results for the other
parameters. In particular, we have found the following minimum configuration the
we consider ``good'' and ``well balanced'' since it does not use the value
\code{1} for any of the parameters.

\begin{center}
	\begin{tabular}{cccc}
		\toprule
		R & T & m & \(\max(\delta)\) \\
		\midrule
		\(8m\) & \(2s\) & \(2\,\mathit{copies}\) & \(2s\) \\
		\bottomrule
	\end{tabular}
\end{center}

If we want to optimize the \standout{total broadcast time}, as we have seen in
\secref{subsec:hd2kr}, we need to increase the broadcast radius or decrease the
size of the hear window. File \code{broadcast-time.ipynb} shows the results with
various combination of these two factors. The configuration used is named
``HighDensityTime''. We use an high value for the maximum number of copies,
since from the plot generated by the \code{2kr.ipynb} script we see a slightly
decrease of the broadcast time with high values for \(m\). For the same reason,
we use a low value for the maximum relay delay. \figref{fig:hdtimeff} shows the
result of the analysis. As we can see, by using low values for \(T\) we can get
lower values for the broadcast time, even with higher values for the broadcast
radius. So, to not sacrifice the energy efficiency, we can lower the size of the
hear window rather than increase the broadcast radius to reduce the broadcast
time.

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{img/hd/broadcasttime-R-ffplot}
	\caption{The broadcast time is lower with higher values of the broadcast
	radius and lower values of the size of the hear
	window (95\% confidence intervals)}\label{fig:hdtimeff}
\end{figure}

We can verify that the model derived with the \(2^{k}r\) analysis is valid. If we
compute, for example, the value for \(R\!=\!17m\) and \(T\!=\!10s\) using the
model we get the result shown in~\eqref{eq:hdtimepredictionexample} (values for
the two parameters are normalized between \(-1\) and \(1\)) which is near the
mean value obtained from the full factorial analysis (\(117.2s\)) and inside its
95\% confidence interval (\(106.7255\), \(127.6745\)).

\begin{equation}\label{eq:hdtimepredictionexample}
	t_B = e^{4.782874 - 0.462452 \cdot 0.4 + 0.240663 \cdot 1} =
	e^{4.8385562} \simeq 126.2869s
\end{equation}

If instead we want to optimize the energy efficiency, we must reduce the
broadcast radius and the total number of messages sent. In file
\code{messages.ipynb} we have performed a factorial analysis with low values for
the broadcast radius. Other factors taken into considerations are the one we
have identified as relevant in \secref{subsec:hd2kr}, namely the maximum number
of copies and the size of the hear window. The configuration used is named
``HighDensityMessages''.

As we can see from \figref{fig:hdmessagesff}, we get that the maximum number of
copies hugely affects the total number of messages sent, as previously found by
the \(2^{k}r\) analysis. Surprisingly, the combination of the maximum number of
copies and the size of the hear window is very important to reduce the number of
messages sent (the lower lines in the plot are those with the higher values for
\(T\)). This contradicts what the \(2^{k}r\) analysis found before.

\begin{figure}
	\centering
	\includegraphics[width=\textwidth]{img/hd/messages-m-ffplot}
	\caption{With low values of the maximum number of copies and higher
	values for the size of the hear window, we get a lower number of
	messages sent}\label{fig:hdmessagesff}
\end{figure}

So, in order to improve the energy efficiency, since we can not increase the
broadcast radius, we need to use a large \(T\) and a low \(m\). Increasing
\(T\) also increases the broadcast time, so a trade-off decision is needed in
this parameter. In order to account for both the indexes, one can increase the
value of \(R\) to reduce the broadcast radius and increase \(T\) maintaining a
low \(m\) in order to compensate for the increment of the energy consumption due
to the higher value of \(R\).

TODO\@: collisions
